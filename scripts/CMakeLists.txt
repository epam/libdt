#make timezones map
include(FindPythonInterp)
set(LIBTZ_TIMEZONES_MAPPING_HEADER ${CMAKE_SOURCE_DIR}/src/timezones_map.h)
set(LIBTZ_TIMEZONES_MAPPING_GENERATOR_SCRIPT ${CMAKE_SOURCE_DIR}/scripts/transform.py)
set(LIBTZ_TIMEZONES_MAPPING_GENERATOR_FALLBACK_SOURCE ${CMAKE_SOURCE_DIR}/resources/windowsZones.xml)

add_custom_command(OUTPUT ${LIBTZ_TIMEZONES_MAPPING_HEADER}
COMMAND ${PYTHON_EXECUTABLE}
ARGS    ${LIBTZ_TIMEZONES_MAPPING_GENERATOR_SCRIPT} ${LIBTZ_TIMEZONES_MAPPING_GENERATOR_FALLBACK_SOURCE} > ${LIBTZ_TIMEZONES_MAPPING_HEADER}
WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
)

SET_SOURCE_FILES_PROPERTIES(${LIBTZ_TIMEZONES_MAPPING_HEADER} PROPERTIES GENERATED 1)

add_custom_target(timezones-map SOURCES ${LIBTZ_TIMEZONES_MAPPING_GENERATOR_SCRIPT}
${LIBTZ_TIMEZONES_MAPPING_HEADER}
${LIBTZ_TIMEZONES_MAPPING_GENERATOR_FALLBACK_SOURCE})

