enable_testing()
find_package(GTest)
if(GTEST_FOUND)
set(TESTS_EXECUTABLE tests)
include_directories(${GTEST_INCLUDE_DIRS})
find_package( Threads )
aux_source_directory(. SRC_LIST)
add_executable(${TESTS_EXECUTABLE} ${SRC_LIST})
target_link_libraries(${TESTS_EXECUTABLE} ${GTEST_BOTH_LIBRARIES} ${CMAKE_THREAD_LIBS_INIT} ${PROJECT_NAME} )
add_test(AllTests tests)
endif()

